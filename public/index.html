<!DOCTYPE html>
<html lang="fr">
    <head>
        <meta charset="UTF-8">
        <title>Nuntius</title>
        <script src="js/react.js"></script>
        <script src="js/react-dom.js"></script>
        <script src="js/browser.min.js"></script>
        <script src="js/fetch.js"></script>
        <script src="js/moment.min.js"></script>
        <script src="https://code.jquery.com/jquery-2.1.4.js"></script>
        <link rel="stylesheet" href="css/style.css">
    </head>
    <body>
		<div id="chat"></div>
        <script type="text/babel">
        	var Chat = React.createClass({

        		getInitialState: function(){
        			return {
	                messages: [],
	                people: 'Lemmy',
	                loading: true
    				  };
        		},
	            componentDidMount: function() {
	              var self = this;
	              
	            },
              sendMessage: function(event){

                var message = {
                  "texte": this.refs.messageText.value,
                  "personne": this.state.people,
                  "date": moment()
                };

                var newtable = this.state.messages.concat([message]);
                this.setState({messages: newtable});
              },
        		render: function(){
	           		console.log(this.state.messages);
	           		return(
	           				<div>
                      <div id="messages">
                      {this.state.messages.map(function(message){
                        return(
                          <div>
                            <p><strong>{message.personne} : </strong>{message.texte}</p>
                            <span>{message.date.format('MMMM Do YYYY, h:mm:ss a')}</span>
                          </div>
                          );
                      })}
                      </div>
	           					<input type="text" ref="messageText"/>
                      <p onClick={this.sendMessage} >Send message</p>
	           				</div>
	           			);
        		}
        	});

        	ReactDOM.render(
        		<Chat />,
        		document.getElementById('chat')
        	);
        </script>
    </body>
</html>
