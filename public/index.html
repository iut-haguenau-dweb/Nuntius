<!DOCTYPE html>
<html lang="fr">
    <head>
        <meta charset="UTF-8">
        <title>Nuntius</title>
        <script src="js/react.js"></script>
        <script src="js/react-dom.js"></script>
        <script src="js/browser.min.js"></script>
        <script src="js/fetch.js"></script>
        <script src="js/moment.min.js"></script>
        <script src="https://code.jquery.com/jquery-2.1.4.js"></script>
        <link rel="stylesheet" href="css/style.css">
        <link href='https://fonts.googleapis.com/css?family=Kaushan+Script' rel='stylesheet' type='text/css'>
    </head>
    <body>

    <div class="wrapper">
    <header>
      <h1>Nuntius</h1>
      <h2>La nouvelle discussion instantann√©e</h2>
    </header>
      <div id="container"></div>
          <script type="text/babel">
            var Chat = React.createClass({

              getInitialState: function(){
                return {
                    messages: [],
                    people: 'Lemmy',
                    loading: true
                };
              },
                componentDidMount: function() {
                  var self = this;
                  
                },
                sendMessage: function(event){

                  var message = {
                    "texte": this.refs.messageText.value,
                    "personne": this.state.people,
                    "date": moment()
                  };

                  var newtable = this.state.messages.concat([message]);
                  this.setState({messages: newtable});
                },
              render: function(){
                  console.log(this.state.messages);
                  return(
                      <div>
                        <div id="chat"></div>
                        <div id="messages">
                        {this.state.messages.map(function(message){
                          return(
                            <div>
                              <p><strong>{message.personne} : </strong>{message.texte}</p>
                              <span>{message.date.format('MMMM Do YYYY, h:mm:ss a')}</span>
                            </div>
                            );
                        })}
                        </div>
                        <input type="text" ref="messageText"/>
                        <p onClick={this.sendMessage} id="send" >Send message</p>
                        <div className="clear"></div>
                      </div>
                    );
              }
            });

            ReactDOM.render(
              <Chat />,
              document.getElementById('container')
            );
          </script>
      </div>
		
    </body>
</html>
